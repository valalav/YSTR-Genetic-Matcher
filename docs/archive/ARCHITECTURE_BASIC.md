# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã DNA-utils-universal

## üèóÔ∏è –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

DNA-utils-universal –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ Y-STR –º–∞—Ä–∫–µ—Ä–æ–≤ –∏ –≥–∞–ø–ª–æ–≥—Ä—É–ø–ø Y-—Ö—Ä–æ–º–æ—Å–æ–º—ã.

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    DNA-utils-universal                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ    STR Matcher      ‚îÇ    FTDNA Haplo     ‚îÇ  YSTr Predictor ‚îÇ
‚îÇ   (Next.js :9002)   ‚îÇ                    ‚îÇ   (Python ML)   ‚îÇ
‚îÇ                     ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ  ‚îÇ Server :9003    ‚îÇ ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ  ‚îÇ React Frontend  ‚îÇ ‚îÇ  ‚îÇ (Node.js/API)  ‚îÇ ‚îÇ  ‚îÇ FastAPI     ‚îÇ ‚îÇ
‚îÇ  ‚îÇ                 ‚îÇ ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ  ‚îÇ (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)‚îÇ ‚îÇ
‚îÇ  ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ  ‚îÇ ‚îÇWeb Workers  ‚îÇ ‚îÇ ‚îÇ  ‚îÇ Client :5173    ‚îÇ ‚îÇ                 ‚îÇ
‚îÇ  ‚îÇ ‚îÇ(STR calc)   ‚îÇ ‚îÇ ‚îÇ  ‚îÇ (React/Vite)    ‚îÇ ‚îÇ                 ‚îÇ
‚îÇ  ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ                 ‚îÇ  
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ                     ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üîó –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### STR Matcher ‚Üî FTDNA Haplo
```mermaid
sequenceDiagram
    participant SM as STR Matcher
    participant API as FTDNA Haplo API
    
    SM->>API: POST /api/check-subclade
    Note over SM,API: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É–±–∫–ª–∞–¥–æ–≤ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
    API-->>SM: {isSubclade: boolean}
    
    SM->>API: GET /api/haplogroup-path/:haplogroup  
    Note over SM,API: –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—É—Ç–µ–π –≤ –¥–µ—Ä–µ–≤–µ
    API-->>SM: {ftdna: path, yfull: path}
```

## üìä –ö–æ–º–ø–æ–Ω–µ–Ω—Ç 1: STR Matcher (–ø–æ—Ä—Ç 9002)

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **Framework**: Next.js 14
- **UI**: React + Tailwind CSS
- **State**: Redux Toolkit + React Hooks
- **Storage**: IndexedDB (–ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ)
- **Workers**: Web Workers –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤
- **HTTP**: Axios –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```
src/
‚îú‚îÄ‚îÄ app/                    # Next.js App Router
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ str-matcher/        # –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ STRMatcher.tsx     # –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MatchesTable.tsx   # –¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DataRepositories.tsx # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ HaplogroupFilter.tsx # –§–∏–ª—å—Ç—Ä –≥–∞–ø–ª–æ–≥—Ä—É–ø–ø
‚îÇ   ‚îî‚îÄ‚îÄ ui/                 # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îú‚îÄ‚îÄ hooks/                  # React —Ö—É–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ useSTRMatcher.ts       # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ useHaplogroups.ts      # –†–∞–±–æ—Ç–∞ —Å –≥–∞–ø–ª–æ–≥—Ä—É–ø–ø–∞–º–∏
‚îú‚îÄ‚îÄ workers/                # Web Workers
‚îÇ   ‚îî‚îÄ‚îÄ comparison.worker.ts   # –†–∞—Å—á–µ—Ç –¥–∏—Å—Ç–∞–Ω—Ü–∏–π
‚îú‚îÄ‚îÄ utils/                  # –£—Ç–∏–ª–∏—Ç—ã
‚îî‚îÄ‚îÄ store/                  # Redux store
```

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

#### Web Workers –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```typescript
// comparison.worker.ts
export class STRComparisonWorker {
  executeMatching(params: MatchingParams): void {
    // –†–∞—Å—á–µ—Ç –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∏—Å—Ç–∞–Ω—Ü–∏–π –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
    // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ UI
  }
}
```

#### –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
1. **Web Worker**: –ü–µ—Ä–≤–∏—á–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏
2. **API –∑–∞–ø—Ä–æ—Å—ã**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É–±–∫–ª–∞–¥–æ–≤ —á–µ—Ä–µ–∑ FTDNA Haplo
3. **Client-side**: –§–∏–Ω–∞–ª—å–Ω—ã–µ UI —Ñ–∏–ª—å—Ç—Ä—ã

#### –°–∏—Å—Ç–µ–º–∞ –≤—ã–¥–µ–ª–µ–Ω–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤
```css
/* 5 —É—Ä–æ–≤–Ω–µ–π —Ä–µ–¥–∫–æ—Å—Ç–∏ */
.marker-rarity-common { background: #fef3f2; }        /* 20-33% */
.marker-rarity-uncommon { background: #fed7cc; }      /* 12-20% */
.marker-rarity-rare { background: #fb9b7a; }          /* 8-12% */
.marker-rarity-very-rare { background: #f97316; }     /* 4-8% */
.marker-rarity-extremely-rare { background: #dc2626; } /* <4% */
```

## üìä –ö–æ–º–ø–æ–Ω–µ–Ω—Ç 2: FTDNA Haplo (–ø–æ—Ä—Ç—ã 9003, 5173)

### –°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å (Node.js :9003)

#### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **Runtime**: Node.js
- **Framework**: Express.js
- **Data Processing**: Custom classes
- **CORS**: –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –¥–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤

#### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤
```
server/
‚îú‚îÄ‚îÄ server.js              # Express —Å–µ—Ä–≤–µ—Ä + –º–∞—Ä—à—Ä—É—Ç—ã
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ haplogroup-service.js  # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ haplo_functions.js     # FTDNA –¥–µ—Ä–µ–≤–æ
‚îú‚îÄ‚îÄ yfull_adapter.js       # YFull –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ search_integration.js  # –ü–æ–∏—Å–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π
‚îî‚îÄ‚îÄ path_builder.js        # –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø—É—Ç–µ–π
```

#### –ö–ª—é—á–µ–≤—ã–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
```javascript
// –û—Å–Ω–æ–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
GET  /api/search/:haplogroup           // –ü–æ–∏—Å–∫ –≥–∞–ø–ª–æ–≥—Ä—É–ø–ø—ã
GET  /api/haplogroup-path/:haplogroup  // –ü—É—Ç—å –≤ –¥–µ—Ä–µ–≤–µ
POST /api/check-subclade               // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É–±–∫–ª–∞–¥–æ–≤ ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô
GET  /api/autocomplete                 // –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
```

### –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å (React/Vite :5173)

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- **HaploViewer.jsx**: –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–∏—Å–∫–∞
- **HaploFilters.jsx**: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤  
- **HaplogroupTree.jsx**: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ—Ä–µ–≤–∞

## üìä –ö–æ–º–ø–æ–Ω–µ–Ω—Ç 3: YSTr Predictor (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

**–°—Ç–∞—Ç—É—Å**: –ó–∞–≥–ª—É—à–∫–∞ –Ω–∞ –±—É–¥—É—â–µ–µ
- Python/FastAPI –æ—Å–Ω–æ–≤–∞
- –ú–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è

## üîÑ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏ (PM2)

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ecosystem.config.js
```javascript
module.exports = {
  apps: [
    {
      name: 'str-matcher-2',
      script: 'next dev',
      cwd: './str-matcher',
      env: { PORT: 9002, NEXT_PUBLIC_API_URL: 'http://host:9003/api' }
    },
    {
      name: 'ftdna-haplo-2',
      script: './server/server.js', 
      cwd: './ftdna_haplo',
      env: { PORT: 9003, ALLOWED_ORIGINS: 'http://host:9002,http://host:5173' }
    },
    {
      name: 'haplo-client',
      script: 'vite --host 0.0.0.0',
      cwd: './ftdna_haplo/client',
      env: { PORT: 5173, VITE_API_URL: 'http://host:9003/api' }
    }
  ]
}
```

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

### STR Profile Format
```typescript
interface STRProfile {
  kitNumber: string;        // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Ç–µ—Å—Ç–∞
  name: string;            // –ò–º—è —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–≥–æ  
  country: string;         // –°—Ç—Ä–∞–Ω–∞
  haplogroup: string;      // –ì–∞–ø–ª–æ–≥—Ä—É–ø–ø–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø–æ–ª–Ω–æ–π)
  markers: {               // Y-STR –º–∞—Ä–∫–µ—Ä—ã
    [marker: string]: string;
  };
}
```

### Haplogroup Details Format
```typescript
interface HaplogroupDetails {
  id: string;
  name: string;
  path: {
    nodes: Array<{
      id: string;
      name: string;
      variants: string[];    // SNP –º–∞—Ä–∫–µ—Ä—ã
    }>;
    string: string;          // "A > B > ... > R-M269"
  };
  statistics: {
    totalKits: number;
    countryStats: CountryStats[];
  };
}
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ CORS

### CORS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```javascript
// –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ origins –¥–ª—è –º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
const allowedOrigins = [
  'http://localhost:9002',   // STR Matcher
  'http://localhost:5173',   // Haplo Client  
  'https://str.aadna.ru:8443' // Production
];
```

### Next.js Proxy Setup
```javascript
// next.config.js - –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ API –∑–∞–ø—Ä–æ—Å–æ–≤
module.exports = {
  async rewrites() {
    return [
      {
        source: '/api/:path*',
        destination: 'http://localhost:9003/api/:path*'
      }
    ]
  }
}
```

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Map-based –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—ã–µ —É–∑–ª—ã YFull
- **IndexedDB**: –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ STR –ø—Ä–æ—Ñ–∏–ª–µ–π
- **Browser cache**: –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—Å—É—Ä—Å—ã

### Lazy Loading
- **Chunked JSON**: –ó–∞–≥—Ä—É–∑–∫–∞ –±–æ–ª—å—à–∏—Ö –±–∞–∑ –ø–æ —á–∞—Å—Ç—è–º
- **Progressive rendering**: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç–∞–±–ª–∏—Ü
- **On-demand**: –î–µ—Ç–∞–ª–∏ –≥–∞–ø–ª–æ–≥—Ä—É–ø–ø –ø–æ –∑–∞–ø—Ä–æ—Å—É

### Web Workers
```typescript
// –†–∞—Å—á–µ—Ç—ã –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
class ComparisonWorker {
  // –†–∞—Å—á–µ—Ç –¥–∏—Å—Ç–∞–Ω—Ü–∏–π –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ UI
  // Batch processing –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
  // Early termination –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤
}
```

## üîç –ê–ª–≥–æ—Ä–∏—Ç–º—ã

### –†–∞—Å—á–µ—Ç –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∏—Å—Ç–∞–Ω—Ü–∏–π
```typescript
enum CalculationMode {
  STANDARD = 'standard',      // –ü—Ä–æ—Å—Ç–æ–π –ø–æ–¥—Å—á–µ—Ç —Ä–∞–∑–ª–∏—á–∏–π
  MODAL = 'modal',           // –£—á–µ—Ç –º—É—Ç–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∫–æ—Ä–æ—Å—Ç–µ–π  
  INFINITE_ALLELE = 'infinite_allele' // –ú–æ–¥–µ–ª—å –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö –∞–ª–ª–µ–ª–µ–π
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É–±–∫–ª–∞–¥–æ–≤ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ!)
```javascript
// –ê–ª–≥–æ—Ä–∏—Ç–º –≤ HaploTree.isSubclade()
isSubclade(haplogroup, parentHaplogroup) {
  // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤—ã—Ö –≥–∞–ø–ª–æ–≥—Ä—É–ø–ø (R, R1, R1a)
  // 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω—ã—Ö –ø—É—Ç–µ–π –≤ –¥–µ—Ä–µ–≤–µ
  // 3. –ü—Ä–æ–≤–µ—Ä–∫–∞: —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø—É—Ç—å —Ä–æ–¥–∏—Ç–µ–ª—è –ø—Ä–µ—Ñ–∏–∫—Å–æ–º –ø—É—Ç–∏ –ø–æ—Ç–æ–º–∫–∞
  const isSubclade = parentPath.every((name, index) => 
    name === haploPath[index]
  );
  return isSubclade;
}
```

## üåê –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### Google Sheets Integration
```typescript
// –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –±–∞–∑—ã
const REPOSITORIES = [
  'AADNA.ru Database',     // –û—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞
  'R1a Database',          // –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –≥–∞–ø–ª–æ–≥—Ä—É–ø–ø–∞–º
  'J1/J2 Database',        // –°–µ–º–∏—Ç—Å–∫–∏–µ –≥–∞–ø–ª–æ–≥—Ä—É–ø–ø—ã
  'G/E/I Databases',       // –ï–≤—Ä–æ–ø–µ–π—Å–∫–∏–µ –≥–∞–ø–ª–æ–≥—Ä—É–ø–ø—ã
  'Genopoisk'              // –†–æ—Å—Å–∏–π—Å–∫–∞—è –±–∞–∑–∞
];
```

### Chunked JSON –¥–ª—è –±–æ–ª—å—à–∏—Ö –±–∞–∑
```javascript
// R1b –±–∞–∑–∞ (16 —á–∞–Ω–∫–æ–≤)
{
  id: 'r1b',
  type: 'chunked_json',
  url: '/chunk_',
  chunks: 16,
  batchSize: 4  // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ 4 —á–∞–Ω–∫–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
}
```

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### 1. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—É–±–∫–ª–∞–¥–∞–º
- **–ù–ï –ø—Ä–æ—Å—Ç–æ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é**: –£—á–∏—Ç—ã–≤–∞–µ—Ç —Ñ–∏–ª–æ–≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤—è–∑–∏
- **–í–∫–ª—é—á–µ–Ω–∏–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –º–∞—Ç—á–µ–π**: –û—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ—Ö, –∫—Ç–æ –º–æ–∂–µ—Ç –ø–æ–¥–æ–π—Ç–∏
- **API –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç check-subclade —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ—Ä–æ—Ç–∫–∏—Ö SNP  
- **–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã**: R-Y6, Y4, Y2, Y3
- **–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: PathBuilder –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
- **–¢–æ—á–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ**: –ò–∑–±–µ–∂–∞–Ω–∏–µ –ª–æ–∂–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π

### 3. –ü–∞–ª–∏–Ω–¥—Ä–æ–º–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã
```typescript
// DYS385, DYS459 –∏ –¥—Ä.
const palindromes = {
  'DYS385': 2,  // –û–∂–∏–¥–∞–µ—Ç—Å—è 2 –∑–Ω–∞—á–µ–Ω–∏—è
  'DYS459': 2,  // –§–æ—Ä–º–∞—Ç: "value1-value2"
  'DYS464': 4   // –ú–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ 4 –∑–Ω–∞—á–µ–Ω–∏–π
};
```

## üöÄ Deployment Architecture

### Development
```bash
npm run dev    # –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ —á–µ—Ä–µ–∑ PM2
```

### Production  
```bash
npm run build  # –°–±–æ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
npm start      # –ó–∞–ø—É—Å–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
```

### Docker Support (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- Containerized –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã
- Docker Compose –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏
- Health checks –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

---

*–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞: –ê–≤–≥—É—Å—Ç 2025*