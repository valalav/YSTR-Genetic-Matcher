# PostgreSQL Integration Plan
## Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ñ‡ĞµÑ€ĞµĞ· PostgreSQL Ñ Ğ¿Ñ€ĞµĞ´Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ±Ğ°Ğ·Ğ°Ğ¼Ğ¸

---

## ğŸ¯ Ğ¦ĞµĞ»ÑŒ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ²Ñ‹ÑĞ¾ĞºĞ¾Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½ÑƒÑ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ³ĞµĞ½ĞµÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… ÑĞ¾Ğ²Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğ¹ Ñ‡ĞµÑ€ĞµĞ· PostgreSQL, Ğ³Ğ´Ğµ:
- **Ğ‘Ğ°Ğ·Ñ‹ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ĞµĞ¹ Ğ¿Ñ€ĞµĞ´Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹** Ğ² Ğ‘Ğ” (162,000+ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ĞµĞ¹)
- **ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ²Ñ‹Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚** Ğ½ÑƒĞ¶Ğ½Ñ‹Ğµ Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹ Ğ¸Ğ· ÑĞ¿Ğ¸ÑĞºĞ°
- **ĞŸĞ¾Ğ¸ÑĞº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¼Ğ³Ğ½Ğ¾Ğ²ĞµĞ½Ğ½Ğ¾** Ğ±Ğ»Ğ°Ğ³Ğ¾Ğ´Ğ°Ñ€Ñ Ğ¸Ğ½Ğ´ĞµĞºÑĞ°Ğ¼ PostgreSQL
- **Ğ˜Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ Ğ°Ğ½Ğ°Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµĞ½** Ñ‚ĞµĞºÑƒÑ‰ĞµĞ¹ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğµ Ğ¼Ğ°Ñ‚Ñ‡ĞµĞ¹ (CSV-based)
- **Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¸ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°** Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚ Ğ±Ñ‹ÑÑ‚Ñ€ĞµĞµ Ñ‡ĞµĞ¼ Ğ² CSV Ğ²ĞµÑ€ÑĞ¸Ğ¸
- **ĞĞ• Ğ»Ğ¾Ğ¼Ğ°ĞµÑ‚ÑÑ** ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ» (CSV matcher)

---

## ğŸ“Š Ğ¢ĞµĞºÑƒÑ‰ĞµĞµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

### âœ… Ğ£Ğ¶Ğµ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾:

1. **PostgreSQL Backend** (`/backend/`)
   - Express ÑĞµÑ€Ğ²ĞµÑ€ Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ‚Ñƒ 9004
   - PostgreSQL connection pool
   - Routes: `/api/profiles/find-matches`, `/api/profiles/upload`
   - Redis ĞºĞµÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²
   - Rate limiting Ğ¸ security middleware

2. **Database Schema** (`/database/schema.sql`)
   - Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° `ystr_profiles` Ñ JSONB markers
   - Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ `calculate_genetic_distance()` Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´ÑÑ‡Ñ‘Ñ‚Ğ° Ğ´Ğ¸ÑÑ‚Ğ°Ğ½Ñ†Ğ¸Ğ¸
   - Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ `find_matches_batch()` Ğ´Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ¸ÑĞºĞ°
   - GIN Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹ Ğ½Ğ° JSONB markers
   - Materialized view Ğ´Ğ»Ñ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸ Ğ¼Ğ°Ñ€ĞºĞµÑ€Ğ¾Ğ²

3. **Frontend Component** (`/str-matcher/src/components/str-matcher/BackendSearch.tsx`)
   - UI Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ¿Ğ¾ kit number
   - UI Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ¿Ğ¾ custom markers
   - ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² Ğ² `AdvancedMatchesTable`
   - Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ‘Ğ” (total profiles, haplogroups, etc.)

4. **API Hooks** (`/str-matcher/src/hooks/useBackendAPI.ts`)
   - `findMatches()` - Ğ¿Ğ¾Ğ¸ÑĞº Ğ¼Ğ°Ñ‚Ñ‡ĞµĞ¹
   - `getProfile()` - Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ Ğ¿Ğ¾ kit number
   - `getDatabaseStats()` - ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ‘Ğ”

### âŒ Ğ§Ñ‚Ğ¾ ĞĞ• Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ / Ğ§ĞµĞ³Ğ¾ Ğ½Ğµ Ñ…Ğ²Ğ°Ñ‚Ğ°ĞµÑ‚:

1. **ĞĞµÑ‚ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞ° Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ° Ğ±Ğ°Ğ· Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿**
   - ĞĞµĞ»ÑŒĞ·Ñ Ğ²Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ "Ğ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ R1b Ğ±Ğ°Ğ·Ñƒ"
   - ĞĞµĞ»ÑŒĞ·Ñ Ğ²Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ "Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ E1b Ğ±Ğ°Ğ·Ñƒ Ğº ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¼"
   - ĞĞµÑ‚ ÑĞ¿Ğ¸ÑĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… Ğ±Ğ°Ğ· Ğ´Ğ»Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸

2. **ĞĞµÑ‚ Ğ¿Ñ€ĞµĞ´Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ĞµĞ¹**
   - Ğ‘Ğ°Ğ·Ğ° Ğ¿ÑƒÑÑ‚Ğ°Ñ (ĞµÑÑ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ 5 Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ñ… Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹)
   - ĞÑƒĞ¶Ğ½Ğ¾ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ 162,000+ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ĞµĞ¹ Ğ¸Ğ· ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ñ… CSV

3. **ĞœĞµĞ´Ğ»ĞµĞ½Ğ½Ğ°Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿**
   - R1b ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ 50,000+ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ĞµĞ¹
   - ĞŸĞ¾Ğ¸ÑĞº Ğ±ĞµĞ· Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ğ±ÑƒĞ´ĞµÑ‚ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ğ¼
   - ĞĞµÑ‚ Ğ¿Ğ°Ñ€Ñ‚Ğ¸Ñ†Ğ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ Ğ¿Ğ¾ Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ°Ğ¼

4. **ĞĞµÑ‚ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ±Ğ°Ğ·Ğ°Ğ¼Ğ¸**
   - ĞĞµÑ‚ UI Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ½Ñ‹Ñ… Ğ±Ğ°Ğ·
   - ĞĞµÑ‚ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸ Ğ¿Ğ¾ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿Ğµ
   - ĞĞµÑ‚ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸ ÑƒĞ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ/Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ±Ğ°Ğ·Ñƒ

5. **Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° Ğ¼Ğ°Ñ‚Ñ‡ĞµĞ¹ Ğ½Ğµ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°**
   - `AdvancedMatchesTable` Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚, Ğ½Ğ¾ Ğ½Ğµ Ğ¿Ñ€Ğ¾Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ° Ğ½Ğ° 10,000+ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°Ñ…
   - ĞĞµÑ‚ Ğ²Ğ¸Ñ€Ñ‚ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ğ´Ğ»Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… ÑĞ¿Ğ¸ÑĞºĞ¾Ğ²
   - ĞĞµÑ‚ Ğ¿Ğ°Ğ³Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸ Ğ½Ğ° backend ÑƒÑ€Ğ¾Ğ²Ğ½Ğµ

---

## ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ

### ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Frontend (Next.js)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   DatabaseManager    â”‚     â”‚   BackendSearchPage     â”‚  â”‚
â”‚  â”‚  (Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿)  â”‚â”€â”€â”€â”€>â”‚  (Ğ¿Ğ¾Ğ¸ÑĞº Ğ¼Ğ°Ñ‚Ñ‡ĞµĞ¹)         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚            â”‚                              â”‚                  â”‚
â”‚            â”‚ useBackendAPI                â”‚                  â”‚
â”‚            v                              v                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          API Route (/api/backend/...)                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ HTTP (port 9004)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€vâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Backend (Express.js)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ POST /find   â”‚  â”‚ GET /databasesâ”‚  â”‚ POST /load-base â”‚  â”‚
â”‚  â”‚   -matches   â”‚  â”‚               â”‚  â”‚                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                  â”‚                    â”‚            â”‚
â”‚         v                  v                    v            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         matchingService + databaseService            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                                   â”‚
â”‚                          v                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Redis Cache (1 hour TTL)                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€vâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   PostgreSQL Database                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ystr_profiles (partitioned by haplogroup)            â”‚  â”‚
â”‚  â”‚  - R1b partition (50,000 profiles)                     â”‚  â”‚
â”‚  â”‚  - R1a partition (30,000 profiles)                     â”‚  â”‚
â”‚  â”‚  - E1b partition (20,000 profiles)                     â”‚  â”‚
â”‚  â”‚  - ... other partitions                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  haplogroup_databases                                  â”‚  â”‚
â”‚  â”‚  (Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ: Ñ€Ğ°Ğ·Ğ¼ĞµÑ€, Ğ´Ğ°Ñ‚Ğ° Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸, ÑÑ‚Ğ°Ñ‚ÑƒÑ)          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Indexes: GIN on markers, B-tree on haplogroup        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ½ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

### **Ğ­Ğ¢ĞĞŸ 1: ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…**

#### 1.1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ Ğ±Ğ°Ğ· Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿
**Ğ¤Ğ°Ğ¹Ğ»:** `database/haplogroup-databases-table.sql`

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ°:**
- Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ `haplogroup_databases` Ğ´Ğ»Ñ Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- ĞŸĞ¾Ğ»Ñ: id, haplogroup, total_profiles, loaded_at, status, source_file, avg_markers

**SQL:**
```sql
CREATE TABLE haplogroup_databases (
    id SERIAL PRIMARY KEY,
    haplogroup VARCHAR(50) NOT NULL UNIQUE,
    total_profiles INTEGER DEFAULT 0,
    loaded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    status VARCHAR(20) DEFAULT 'active', -- active, loading, error
    source_file VARCHAR(255),
    avg_markers DECIMAL(5,2),
    description TEXT
);

CREATE INDEX idx_haplogroup_databases_status ON haplogroup_databases(status);
```

#### 1.2. Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ğ°Ñ€Ñ‚Ğ¸Ñ†Ğ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ ystr_profiles
**Ğ¤Ğ°Ğ¹Ğ»:** `database/partitioning.sql`

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ°:**
- Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ğ°Ñ€Ñ‚Ğ¸Ñ†Ğ¸Ğ¸ Ğ´Ğ»Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿ (R1b, R1a, E1b, J, G, I, N, Q)
- ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾Ğ¸ÑĞº Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ Ğ¿Ğ°Ñ€Ñ‚Ğ¸Ñ†Ğ¸Ğ¹

**SQL:**
```sql
-- ĞŸĞ°Ñ€Ñ‚Ğ¸Ñ†Ğ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾ Ñ…ĞµÑˆÑƒ haplogroup
ALTER TABLE ystr_profiles RENAME TO ystr_profiles_old;

CREATE TABLE ystr_profiles (
    LIKE ystr_profiles_old INCLUDING ALL
) PARTITION BY HASH (haplogroup);

-- Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ 16 Ğ¿Ğ°Ñ€Ñ‚Ğ¸Ñ†Ğ¸Ğ¹ Ğ´Ğ»Ñ Ñ€Ğ°Ğ²Ğ½Ğ¾Ğ¼ĞµÑ€Ğ½Ğ¾Ğ³Ğ¾ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ
CREATE TABLE ystr_profiles_p0 PARTITION OF ystr_profiles
    FOR VALUES WITH (MODULUS 16, REMAINDER 0);
-- ... repeat for p1 through p15

-- ĞŸĞµÑ€ĞµĞ½ĞµÑÑ‚Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸Ğ· ÑÑ‚Ğ°Ñ€Ğ¾Ğ¹ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹
INSERT INTO ystr_profiles SELECT * FROM ystr_profiles_old;
DROP TABLE ystr_profiles_old;
```

#### 1.3. ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ find_matches_batch
**Ğ¤Ğ°Ğ¹Ğ»:** `database/optimized-find-matches.sql`

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ°:**
- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºÑƒ Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ñ… Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿ (`haplogroupFilters: string[]`)
- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ğ°Ğ³Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ (offset, limit)
- Ğ£Ğ»ÑƒÑ‡ÑˆĞ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ´Ğ»Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²

---

### **Ğ­Ğ¢ĞĞŸ 2: Backend API Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ±Ğ°Ğ·Ğ°Ğ¼Ğ¸**

#### 2.1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ DatabaseService
**Ğ¤Ğ°Ğ¹Ğ»:** `backend/services/databaseService.js`

**ĞœĞµÑ‚Ğ¾Ğ´Ñ‹:**
- `listAvailableDatabases()` - ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… CSV Ğ±Ğ°Ğ· Ğ² `/data/haplogroups/`
- `getLoadedDatabases()` - ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ½Ñ‹Ñ… Ğ±Ğ°Ğ· Ğ¸Ğ· `haplogroup_databases`
- `loadDatabase(haplogroup, csvFilePath)` - Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ CSV Ğ² PostgreSQL
- `deleteDatabase(haplogroup)` - ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ĞµĞ¹ Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹
- `getDatabaseStats(haplogroup)` - ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿Ğµ

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€:**
```javascript
class DatabaseService {
  async listAvailableDatabases() {
    // Ğ¡ĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ /data/haplogroups/ Ğ´Ğ»Ñ CSV Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²
    // Ğ’ĞµÑ€Ğ½ÑƒÑ‚ÑŒ [{haplogroup: 'R1b', filename: 'R1b.csv', size: '50MB'}, ...]
  }

  async loadDatabase(haplogroup, csvFilePath, options = {}) {
    // 1. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ status = 'loading' Ğ² haplogroup_databases
    // 2. ĞŸÑ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ CSV Ñ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰ÑŒÑ Papa Parse
    // 3. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ bulk_insert_profiles() Ğ´Ğ»Ñ Ğ²ÑÑ‚Ğ°Ğ²ĞºĞ¸
    // 4. ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ (total_profiles, avg_markers)
    // 5. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ status = 'active'
  }
}
```

#### 2.2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ routes Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ±Ğ°Ğ·Ğ°Ğ¼Ğ¸
**Ğ¤Ğ°Ğ¹Ğ»:** `backend/routes/databases.js`

**Endpoints:**
- `GET /api/databases/available` - ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… CSV Ğ±Ğ°Ğ·
- `GET /api/databases/loaded` - ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ½Ñ‹Ñ… Ğ±Ğ°Ğ·
- `POST /api/databases/load` - Ğ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Ğ±Ğ°Ğ·Ñƒ Ğ¸Ğ· CSV
- `DELETE /api/databases/:haplogroup` - ÑƒĞ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ±Ğ°Ğ·Ñƒ
- `GET /api/databases/:haplogroup/stats` - ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ Ğ±Ğ°Ğ·Ğµ

#### 2.3. ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ matchingService Ğ´Ğ»Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾ Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¼ Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ°Ğ¼
**Ğ¤Ğ°Ğ¹Ğ»:** `backend/services/matchingService.js`

**Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ:**
- ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° `haplogroupFilters: string[]` Ğ²Ğ¼ĞµÑÑ‚Ğ¾ `haplogroupFilter: string`
- Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ `IN (...)` Ğ²Ğ¼ĞµÑÑ‚Ğ¾ `LIKE`
- ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ²

---

### **Ğ­Ğ¢ĞĞŸ 3: Frontend ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹**

#### 3.1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ DatabaseManager ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚
**Ğ¤Ğ°Ğ¹Ğ»:** `str-matcher/src/components/str-matcher/DatabaseManager.tsx`

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»:**
- Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ñ… Ğ±Ğ°Ğ· (Ğ¸Ğ· CSV)
- Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ½Ñ‹Ñ… Ğ±Ğ°Ğ· (Ğ¸Ğ· PostgreSQL)
- ĞšĞ½Ğ¾Ğ¿ĞºĞ° "Load Database" Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾Ğ¹ Ğ±Ğ°Ğ·Ñ‹
- ĞŸÑ€Ğ¾Ğ³Ñ€ĞµÑÑ-Ğ±Ğ°Ñ€ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸
- Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°: profiles, avg markers, loaded date
- ĞšĞ½Ğ¾Ğ¿ĞºĞ° "Delete" Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ½Ğ¾Ğ¹ Ğ±Ğ°Ğ·Ñ‹

**UI:**
```tsx
<div>
  <h2>Available Databases (CSV)</h2>
  <table>
    <tr>
      <td>R1b</td>
      <td>50,234 profiles</td>
      <td>R1b.csv (45MB)</td>
      <td><button>Load to PostgreSQL</button></td>
    </tr>
  </table>

  <h2>Loaded Databases (PostgreSQL)</h2>
  <table>
    <tr>
      <td>R1a</td>
      <td>32,156 profiles</td>
      <td>Loaded: 2025-10-01</td>
      <td><button>Delete</button></td>
    </tr>
  </table>
</div>
```

#### 3.2. Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿ Ğ² BackendSearch
**Ğ¤Ğ°Ğ¹Ğ»:** `str-matcher/src/components/str-matcher/BackendSearch.tsx`

**Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ:**
- Dropdown "Select Haplogroups" Ñ Ğ¼ÑƒĞ»ÑŒÑ‚Ğ¸Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğ¼
- Ğ§ĞµĞºĞ±Ğ¾ĞºÑÑ‹ Ğ´Ğ»Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ½Ñ‹Ñ… Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿
- ĞŸĞµÑ€ĞµĞ´Ğ°Ğ²Ğ°Ñ‚ÑŒ `haplogroupFilters: ['R1b', 'R1a']` Ğ² API

#### 3.3. ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ AdvancedMatchesTable
**Ğ¤Ğ°Ğ¹Ğ»:** `str-matcher/src/components/str-matcher/AdvancedMatchesTable.tsx`

**Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ:**
- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ react-window Ğ´Ğ»Ñ Ğ²Ğ¸Ñ€Ñ‚ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ (10,000+ ÑÑ‚Ñ€Ğ¾Ğº)
- Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑĞµÑ€Ğ²ĞµÑ€Ğ½ÑƒÑ Ğ¿Ğ°Ğ³Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ (offset/limit)
- Ğ›ĞµĞ½Ğ¸Ğ²Ğ°Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°: "Load More" ĞºĞ½Ğ¾Ğ¿ĞºĞ°

---

### **Ğ­Ğ¢ĞĞŸ 4: Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…**

#### 4.1. ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¸Ñ‚ÑŒ CSV Ğ±Ğ°Ğ·Ñ‹ Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿
**Ğ”Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ:** `/data/haplogroups/`

**Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ°:**
- Ğ Ğ°Ğ·Ğ´ĞµĞ»Ğ¸Ñ‚ÑŒ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ CSV Ğ½Ğ° Ñ„Ğ°Ğ¹Ğ»Ñ‹ Ğ¿Ğ¾ Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ°Ğ¼
- Ğ¤Ğ°Ğ¹Ğ»Ñ‹: `R1b.csv`, `R1a.csv`, `E1b.csv`, Ğ¸ Ñ‚.Ğ´.

**Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚:**
```bash
node scripts/split-csv-by-haplogroup.js
```

#### 4.2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ CLI Ğ´Ğ»Ñ Ğ¼Ğ°ÑÑĞ¾Ğ²Ğ¾Ğ¹ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸
**Ğ¤Ğ°Ğ¹Ğ»:** `backend/scripts/load-all-databases.js`

**Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:**
```bash
node backend/scripts/load-all-databases.js --dir ./data/haplogroups
```

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»:**
- Ğ¡ĞºĞ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ Ğ´Ğ¸Ñ€ĞµĞºÑ‚Ğ¾Ñ€Ğ¸Ñ
- Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ CSV Ñ‡ĞµÑ€ĞµĞ· API
- ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ-Ğ±Ğ°Ñ€

---

### **Ğ­Ğ¢ĞĞŸ 5: Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ**

#### 5.1. ĞĞ°Ğ³Ñ€ÑƒĞ·Ğ¾Ñ‡Ğ½Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- ĞŸÑ€Ğ¾Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾Ğ¸ÑĞº Ñ 162,000 Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑĞ¼Ğ¸
- Ğ—Ğ°Ğ¼ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ²Ñ€ĞµĞ¼Ñ Ğ¾Ñ‚ĞºĞ»Ğ¸ĞºĞ° Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ğ½Ñ‹Ñ… Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿
- Ğ¦ĞµĞ»ÑŒ: < 500ms Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ² R1b (50k profiles)

#### 5.2. ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ SQL
- ĞĞ½Ğ°Ğ»Ğ¸Ğ· slow queries Ñ‡ĞµÑ€ĞµĞ· `pg_stat_statements`
- ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° work_mem, shared_buffers
- Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ… Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ²

#### 5.3. UI/UX Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ 10,000+ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²
- Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ÑŒÑÑ Ñ‡Ñ‚Ğ¾ Ğ²Ğ¸Ñ€Ñ‚ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¿Ğ»Ğ°Ğ²Ğ½Ğ¾
- ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ½Ğµ Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒĞµÑ‚ UI

---

## ğŸ¯ ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¸ ÑƒÑĞ¿ĞµÑ…Ğ°

### ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:
- âœ… ĞŸĞ¾Ğ¸ÑĞº Ğ² R1b (50k profiles) < 500ms
- âœ… ĞŸĞ¾Ğ¸ÑĞº Ğ² R1a (30k profiles) < 300ms
- âœ… Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ±Ğ°Ğ·Ñ‹ (50k profiles) < 2 Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñ‹
- âœ… ĞÑ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ 10,000 Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ² Ğ±ĞµĞ· Ğ»Ğ°Ğ³Ğ¾Ğ²

### Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ:
- âœ… ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ²Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ°
- âœ… Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€ÑƒÑÑ‚ÑÑ Ğ¸ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€ÑƒÑÑ‚ÑÑ ĞºĞ°Ğº Ğ² CSV Ğ²ĞµÑ€ÑĞ¸Ğ¸
- âœ… Haplogroup tree Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ (ÑÑÑ‹Ğ»ĞºĞ° Ğ½Ğ° FTDNA/YFull)
- âœ… CSV matcher Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°ĞµÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ (Ğ½Ğµ ÑĞ»Ğ¾Ğ¼Ğ°Ğ½)

### Ğ£Ğ´Ğ¾Ğ±ÑÑ‚Ğ²Ğ¾:
- âœ… UI Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ±Ğ°Ğ·Ğ°Ğ¼Ğ¸ (load/delete)
- âœ… Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ Ğ±Ğ°Ğ·Ğµ
- âœ… ĞŸÑ€Ğ¾Ğ³Ñ€ĞµÑÑ-Ğ±Ğ°Ñ€ Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ
- âœ… ĞŸĞ¾Ğ½ÑÑ‚Ğ½Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ğ¾Ğ± Ğ¾ÑˆĞ¸Ğ±ĞºĞ°Ñ…

---

## ğŸ“Š ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ·Ğ°Ğ´Ğ°Ñ‡

### **HIGH Priority** (ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ğ¾ Ğ´Ğ»Ñ MVP):
1. Ğ­Ğ¢ĞĞŸ 1.2 - ĞŸĞ°Ñ€Ñ‚Ğ¸Ñ†Ğ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ (Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ R1b)
2. Ğ­Ğ¢ĞĞŸ 2.1 - DatabaseService (Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…)
3. Ğ­Ğ¢ĞĞŸ 2.2 - Database routes (API Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ)
4. Ğ­Ğ¢ĞĞŸ 3.1 - DatabaseManager UI (Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ±Ğ°Ğ·)
5. Ğ­Ğ¢ĞĞŸ 4.1 - ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° CSV

### **MEDIUM Priority** (Ğ²Ğ°Ğ¶Ğ½Ğ¾, Ğ½Ğ¾ Ğ½Ğµ Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒĞµÑ‚):
6. Ğ­Ğ¢ĞĞŸ 1.3 - ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ find_matches_batch
7. Ğ­Ğ¢ĞĞŸ 3.2 - ĞœÑƒĞ»ÑŒÑ‚Ğ¸Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿
8. Ğ­Ğ¢ĞĞŸ 3.3 - Ğ’Ğ¸Ñ€Ñ‚ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹
9. Ğ­Ğ¢ĞĞŸ 4.2 - CLI Ğ´Ğ»Ñ Ğ¼Ğ°ÑÑĞ¾Ğ²Ğ¾Ğ¹ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸

### **LOW Priority** (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾):
10. Ğ­Ğ¢ĞĞŸ 1.1 - ĞœĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ±Ğ°Ğ· (Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ Ğ¿Ğ¾Ğ·Ğ¶Ğµ)
11. Ğ­Ğ¢ĞĞŸ 5.1 - ĞĞ°Ğ³Ñ€ÑƒĞ·Ğ¾Ñ‡Ğ½Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
12. Ğ­Ğ¢ĞĞŸ 5.2 - SQL Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°Ğ¼ Ñ‚ĞµÑÑ‚Ğ¾Ğ²)

---

## ğŸš€ ĞŸĞ»Ğ°Ğ½ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ (Ğ¿Ğ¾ÑˆĞ°Ğ³Ğ¾Ğ²Ñ‹Ğ¹)

### ĞĞµĞ´ĞµĞ»Ñ 1: Backend + Database
1. Day 1: ĞŸĞ°Ñ€Ñ‚Ğ¸Ñ†Ğ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ystr_profiles
2. Day 2: DatabaseService (load, delete, stats)
3. Day 3: Database routes API
4. Day 4: Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ° Ğ½Ğ° Ğ¼Ğ°Ğ»Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
5. Day 5: ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ find_matches_batch

### ĞĞµĞ´ĞµĞ»Ñ 2: Frontend + Data Import
6. Day 6: DatabaseManager ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚
7. Day 7: Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Backend API
8. Day 8: ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° CSV Ğ±Ğ°Ğ·
9. Day 9: ĞœĞ°ÑÑĞ¾Ğ²Ğ°Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
10. Day 10: Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ±Ğ°Ğ³-Ñ„Ğ¸ĞºÑÑ‹

### ĞĞµĞ´ĞµĞ»Ñ 3: Optimization + Polish
11. Day 11: Ğ’Ğ¸Ñ€Ñ‚ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ AdvancedMatchesTable
12. Day 12: ĞœÑƒĞ»ÑŒÑ‚Ğ¸Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿
13. Day 13: ĞĞ°Ğ³Ñ€ÑƒĞ·Ğ¾Ñ‡Ğ½Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
14. Day 14: Ğ¤Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
15. Day 15: Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¸ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹

---

## ğŸ”§ Ğ¢ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸

### PostgreSQL Partitioning Strategy:
```sql
-- HASH partitioning Ğ´Ğ»Ñ Ñ€Ğ°Ğ²Ğ½Ğ¾Ğ¼ĞµÑ€Ğ½Ğ¾Ğ³Ğ¾ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ
PARTITION BY HASH (haplogroup)
-- 16 Ğ¿Ğ°Ñ€Ñ‚Ğ¸Ñ†Ğ¸Ğ¹ Ğ¾Ğ±ĞµÑĞ¿ĞµÑ‡Ğ°Ñ‚ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ Ğ¼ĞµĞ¶Ğ´Ñƒ:
-- - Ğ¡ĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒÑ Ğ¿Ğ¾Ğ¸ÑĞºĞ° (Ğ¼ĞµĞ½ÑŒÑˆĞµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ½Ğ° Ğ¿Ğ°Ñ€Ñ‚Ğ¸Ñ†Ğ¸Ñ)
-- - Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼Ğ¾ÑÑ‚ÑŒÑ (Ğ½Ğµ ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ°Ñ€Ñ‚Ğ¸Ñ†Ğ¸Ğ¹)
```

### Redis Caching Strategy:
```javascript
// Cache key structure:
`match:${hashMarkers(markers)}:d${maxDistance}:h${haplogroup}`

// TTL: 1 hour (3600 seconds)
// Invalidation: Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ/ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğ¸ Ğ±Ğ°Ğ·
```

### CSV Import Optimization:
```javascript
// Batch size: 5000 profiles per transaction
// Parallel processing: 4 workers
// Estimated speed: 500 profiles/second
// Total time for 162k: ~5 minutes
```

---

## âš ï¸ Ğ Ğ¸ÑĞºĞ¸ Ğ¸ Ğ¼Ğ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ

### Ğ Ğ¸ÑĞº 1: ĞœĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº Ğ² Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ğ³Ğ°Ğ¿Ğ»Ğ¾Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ°Ñ…
**ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ:**
- ĞŸĞ°Ñ€Ñ‚Ğ¸Ñ†Ğ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹
- GIN Ğ¸Ğ½Ğ´ĞµĞºÑÑ‹ Ğ½Ğ° JSONB
- Redis ĞºĞµÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ maxResults

### Ğ Ğ¸ÑĞº 2: Ğ”Ğ¾Ğ»Ğ³Ğ°Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° CSV
**ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ:**
- Background jobs Ñ Ğ¿Ñ€Ğ¾Ğ³Ñ€ĞµÑÑ-Ğ±Ğ°Ñ€Ğ¾Ğ¼
- Batch inserts (5000 per transaction)
- ĞŸĞ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°

### Ğ Ğ¸ÑĞº 3: Ğ¡Ğ»Ğ¾Ğ¼Ğ°ĞµÑ‚ÑÑ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹ CSV matcher
**ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ:**
- Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ñ€Ğ¾ÑƒÑ‚ `/backend-search`
- ĞĞµ Ñ‚Ñ€Ğ¾Ğ³Ğ°Ñ‚ÑŒ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹ ĞºĞ¾Ğ´ STRMatcher
- Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¾Ğ±Ğ° Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ğ° Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ¾

### Ğ Ğ¸ÑĞº 4: ĞŸĞµÑ€ĞµĞ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ Ğ¿Ñ€Ğ¸ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ñ… Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°Ñ…
**ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ:**
- Ğ¡ĞµÑ€Ğ²ĞµÑ€Ğ½Ğ°Ñ Ğ¿Ğ°Ğ³Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ (limit/offset)
- Ğ’Ğ¸Ñ€Ñ‚ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ½Ğ° frontend (react-window)
- ĞĞ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ maxResults = 10,000

---

## ğŸ“š Ğ¡Ğ¿Ñ€Ğ°Ğ²Ğ¾Ñ‡Ğ½Ğ°Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ

### ĞŸĞ¾Ñ…Ğ¾Ğ¶Ğ¸Ğµ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñ‹:
- FTDNA Big Y Block Tree (Ğ¿Ğ°Ñ€Ñ‚Ğ¸Ñ†Ğ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾ SNP)
- YFull YTree (Ğ¸ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ)
- GEDmatch (batch genetic matching)

### ĞŸĞ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ ÑÑÑ‹Ğ»ĞºĞ¸:
- PostgreSQL Partitioning: https://www.postgresql.org/docs/current/ddl-partitioning.html
- GIN Indexes: https://www.postgresql.org/docs/current/gin.html
- React Window: https://github.com/bvaughn/react-window

---

## âœ… Checklist Ğ¿ĞµÑ€ĞµĞ´ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ¾Ğ¼

- [ ] Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ÑŒÑÑ Ñ‡Ñ‚Ğ¾ PostgreSQL Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½ (Ğ¿Ğ¾Ñ€Ñ‚ 5432)
- [ ] Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ÑŒÑÑ Ñ‡Ñ‚Ğ¾ Redis Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½ (Ğ¿Ğ¾Ñ€Ñ‚ 6379)
- [ ] Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ÑŒÑÑ Ñ‡Ñ‚Ğ¾ backend Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½ (Ğ¿Ğ¾Ñ€Ñ‚ 9004)
- [ ] Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ backup Ñ‚ĞµĞºÑƒÑ‰ĞµĞ¹ Ğ‘Ğ”
- [ ] ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğµ CSV Ñ„Ğ°Ğ¹Ğ»Ñ‹
- [ ] ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ CSV matcher Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ (Ğ½Ğµ Ğ»Ğ¾Ğ¼Ğ°Ñ‚ÑŒ!)
- [ ] Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ²ĞµÑ‚ĞºÑƒ `feature/postgres-integration`

---

**Ğ”Ğ°Ñ‚Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ:** 2025-10-04
**ĞĞ²Ñ‚Ğ¾Ñ€:** Claude Code
**Ğ’ĞµÑ€ÑĞ¸Ñ:** 1.0
